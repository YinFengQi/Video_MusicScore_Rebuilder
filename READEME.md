code refactoring ...

a lot unimplemented now